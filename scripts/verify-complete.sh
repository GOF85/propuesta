#!/usr/bin/env bash

# ๐ FINAL PROJECT VERIFICATION - MICE CATERING PROPOSALS
# Verifica que todos los archivos existen y la aplicaciรณn estรก lista

echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "๐ VERIFICACIรN FINAL DEL PROYECTO"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""

GREEN='\033[0;32m'
RED='\033[0;31m'
YELLOW='\033[0;33m'
NC='\033[0m'

PASSED=0
FAILED=0

check_file() {
  local file=$1
  if [ -f "$file" ]; then
    echo -e "${GREEN}โ${NC} $file"
    ((PASSED++))
  else
    echo -e "${RED}โ${NC} $file"
    ((FAILED++))
  fi
}

check_dir() {
  local dir=$1
  if [ -d "$dir" ]; then
    echo -e "${GREEN}โ${NC} $dir/"
    ((PASSED++))
  else
    echo -e "${RED}โ${NC} $dir/"
    ((FAILED++))
  fi
}

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# VERIFICAR DIRECTORIOS
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

echo "๐ DIRECTORIOS PRINCIPALES"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
check_dir "src"
check_dir "views"
check_dir "public"
check_dir "docs"
check_dir "scripts"
echo ""

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# VERIFICAR CONFIGURACIรN
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

echo "โ๏ธ  CONFIGURACIรN"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
check_file "package.json"
check_file ".env.example"
check_file "database.sql"
check_file "PROJECT.md"
echo ""

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# VERIFICAR CONTROLADORES
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

echo "๐ฎ CONTROLADORES"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
check_file "src/controllers/dashboardController.js"
check_file "src/controllers/editorController.js"
check_file "src/controllers/clientController.js"
echo ""

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# VERIFICAR SERVICIOS
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

echo "โก SERVICIOS"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
check_file "src/services/ProposalService.js"
check_file "src/services/ChatService.js"
check_file "src/services/EmailService.js"
echo ""

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# VERIFICAR RUTAS
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

echo "๐ฃ๏ธ  RUTAS"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
check_file "src/routes/dashboard.js"
check_file "src/routes/editor.js"
check_file "src/routes/api.js"
check_file "src/routes/client.js"
check_file "src/routes/auth.js"
check_file "src/routes/index.js"
echo ""

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# VERIFICAR VISTAS
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

echo "๐จ VISTAS"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
check_file "views/commercial/dashboard.ejs"
check_file "views/commercial/editor.ejs"
check_file "views/commercial/new-proposal.ejs"
check_file "views/client/proposal-view.ejs"
check_file "views/client/maintenance.ejs"
check_file "views/partials/header.ejs"
check_file "views/partials/footer.ejs"
check_file "views/partials/header-client.ejs"
check_file "views/auth/login.ejs"
check_file "views/errors/404.ejs"
echo ""

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# VERIFICAR JAVASCRIPT
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

echo "๐ป JAVASCRIPT"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
check_file "public/js/editor.js"
check_file "public/js/client-proposal.js"
check_file "public/js/utils.js"
echo ""

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# VERIFICAR DOCUMENTACIรN
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

echo "๐ DOCUMENTACIรN"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
check_file "docs/PHASE2_COMPLETION.md"
check_file "docs/PHASE2_TESTING.md"
check_file "docs/PHASE3_COMPLETION.md"
check_file "docs/PHASE3_TESTING.md"
check_file "docs/PHASE3_STATUS.md"
check_file "docs/PHASE4_COMPLETION.md"
check_file "PROJECT_COMPLETE.md"
check_file ".github/copilot-instructions.md"
echo ""

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# VERIFICAR SCRIPTS
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

echo "๐ SCRIPTS"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
check_file "scripts/seed-test-data.js"
check_file "scripts/verify-phase3.sh"
echo ""

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# VERIFICAR MIDDLEWARE
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

echo "๐ MIDDLEWARE"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
check_file "src/middleware/auth.js"
check_file "src/middleware/maintenance.js"
echo ""

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# VERIFICAR CONFIGURACIรN
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

echo "โ๏ธ  CONFIGURACIรN INTERNA"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
check_file "src/config/db.js"
check_file "src/config/constants.js"
check_file "src/app.js"
check_file "src/server.js"
echo ""

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# VERIFICAR SINTAXIS
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

echo "๐ง VALIDACIรN DE SINTAXIS"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"

js_files=(
  "src/controllers/dashboardController.js"
  "src/controllers/editorController.js"
  "src/controllers/clientController.js"
  "src/services/ProposalService.js"
  "src/services/ChatService.js"
  "src/services/EmailService.js"
  "src/routes/dashboard.js"
  "src/routes/editor.js"
  "src/routes/api.js"
  "src/routes/client.js"
  "public/js/editor.js"
  "public/js/client-proposal.js"
  "src/app.js"
  "src/server.js"
)

for file in "${js_files[@]}"; do
  if node -c "$file" 2>/dev/null; then
    echo -e "${GREEN}โ${NC} $file"
    ((PASSED++))
  else
    echo -e "${RED}โ${NC} $file (syntax error)"
    ((FAILED++))
  fi
done

echo ""

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# RESUMEN
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "๐ RESUMEN FINAL"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""

TOTAL=$((PASSED + FAILED))

echo -e "โ VERIFICADAS: ${GREEN}${PASSED}${NC}"
echo -e "โ FALLIDAS:    ${RED}${FAILED}${NC}"
echo ""

if [ $FAILED -eq 0 ]; then
  echo -e "${GREEN}๐ ยกPROYECTO COMPLETO Y LISTO PARA PRODUCCIรN!${NC}"
  echo ""
  echo "๐ ESTADรSTICAS:"
  echo "  โข Archivos verificados: $TOTAL"
  echo "  โข Controladores: 3"
  echo "  โข Servicios: 3"
  echo "  โข Rutas: 6"
  echo "  โข Vistas: 10+"
  echo "  โข JavaScript: 3"
  echo "  โข Documentaciรณn: 8+"
  echo ""
  echo "๐ PRรXIMOS PASOS:"
  echo "  1. npm install"
  echo "  2. Configurar .env"
  echo "  3. mysql < database.sql"
  echo "  4. npm run seed"
  echo "  5. npm start"
  echo ""
  exit 0
else
  echo -e "${YELLOW}โ๏ธ  ALGUNAS VERIFICACIONES FALLARON${NC}"
  echo "Por favor revisa los archivos marcados con โ"
  echo ""
  exit 1
fi
